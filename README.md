# Sprint 9

## Wiki
Information in this readMe can also be found in the repository wiki, which will have the most up-to-date information on navigating and using the web app via the VM.


## URL

Our website stub is currently accessible at http://www.cis3760team204.com/
You will be redirected to https://www.cis3760team204.com/

## The VM

Our VM is a Linux VM in Amazon Lightsail. It is in amazon webservices so you cannot get into it unless you have have a AWS account that is register in our group, and has been given permissions.


## About 

In the VM, the front end code is located in `/opt/bitnami/myreactapp`

The code that is there is the files from `group204project/build/` in this repo.
They are generated by running `npm run build` in `/group204project` directory, which contains a react app for the front end.
It also has boot strap for styling.

## Connect to server using vscode

1. Navigate to aws lightsail Home page, Open the instance you want to connect to.
1. under the "Connect" tab, click on "Download default key", make sure there are no space in the file path.
1. run chgmod 600 ".pem file path" in command line, if you are using windows, follow this guide: https://superuser.com/questions/1296024/windows-ssh-permissions-for-private-key-are-too-open

1. install Remote SSH extension for VS code
1. open command palette in vs code, look for "Remote-SSH: Open SSH configuration file".
1. edit the config file, it should look something like this
```
    Host cis3760
    HostName **********
    IdentityFile C:\aws_key_files\LightsailDefaultKey-ca-central-1.pem
    User bitnami
```
## Development react

1. Make changes in `/group204project`
2. test on local host by running `npm start`
3. When satisfied with changes, run `npm run build` to regenerate build files with your updates
4. Run the script `./move_build_files.sh` in the root of this repo to send your build files to nginx.
5. Your changes should show up on https://www.cis3760team204.com/ now, but if they don't you can restart nginx with the command: `sudo /opt/bitnami/ctlscript.sh restart nginx`

## Development flask
1. Make changes `/group204project/flask/app.py`
2. Push changes to repo
3. Copy over or move changes to stack/flask/app.py
4. Run sudo systemctl restart flask
5. Use curl -i <path to call>to check if call is working as intended

## Nginx Configuration

The files in `conf_files` are located in `/opt/bitnami/nginx/conf/server_blocks/` on the VM.

## Installation Script 

To install required things run `./install_script.sh`

## Flask Debugging

1. Check to make sure https in /opt/bitnami/nginx/conf/server_blocks/ passes proximity to 0.0.0.0:5000 and include proxy params
2. sudo nginx -t will tell you if anything is wrong with the conf files
3. sudo systemctl status flask will tell you about any errors with gunicorn and binding
4. Should the binding fail it is most likly due to the port being in use, stop flask if it still is not binding kill the process that is binding to that port, sudo netstat -tulpn | grep LISTEN will show you all the ports, it should be on python3


## Test Cases Running

Test frontend functionality on local by running `pytest -s frontendTesting.py` under `automatedTesting` folder


## javascript calendar library

https://fullcalendar.io/

## Troubleshooting
If the buttons do not appear to be working on your browser, the issue may be resolved by running the Chrome extension "CORS Unblock", which will prevent an error that occurs only on some environments.

## New Features
### Semester Options:

The timetable creator is now able to manage courses for both the Fall 2022 and Winter 2023 semesters.  Select the semester you would like to work in from the dropdown on the top left.  The displayed calendar and searched results will update based on the selected semester.  Your selected courses will be saved when switching between semesters so your courses will remain in your timetable depending on your selected semester.

### Generate PDF:

This button will create and download a PDF copy of the timetable. To be able to download in a nice format on Chrome, please change the default settings to Landscape Layout, A4 Paper Size, Margins for None, and Custom Scale to 60.

### Screen Reader:

This text-to-speech feature is for web accesibility, which targets people with disabilities.

### Dark Mode:

User can swicth screen surface color during days and nights.
